---
import { createAvatar } from "@dicebear/core";
import { shapes } from "@dicebear/collection";

interface Props {
  seed: string;
  size?: number;
}

const { seed, size = 500 } = Astro.props;

// Brand palette (no #)
const palette = ["60a5fa", "2563eb", "3b82f6", "a855f7", "f472b6", "e5e7eb"];

const avatar = createAvatar(shapes, {
  seed,
  size,

  // Use transparent background so we can insert a gradient behind it
  // backgroundColor: ["0000"],

  shape1Color: palette,
  shape2Color: palette,
  shape3Color: palette,

  scale: 100,
  translateX: 0,
  translateY: 0,
  rotate: 0,
});

// Get raw SVG
let svg = avatar.toString();

// Insert a <defs> gradient + background rect
const gradientSvg = `
  <svg width="100%" height="100%" viewBox="0 0 ${size} ${size}" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="thumbGradient" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0%" stop-color="#3b82f6" /> <!-- gradient-a -->
        <stop offset="50%" stop-color="#a855f7" /> <!-- gradient-b -->
        <stop offset="100%" stop-color="#f472b6" /> <!-- gradient-c -->
      </linearGradient>
    </defs>

    <!-- background gradient -->
    <rect width="100%" height="100%" fill="url(#thumbGradient)" rx="30" />

    <!-- DiceBear output -->
    <g>${svg}</g>
  </svg>
`;
---

<div class="w-full h-full" set:html={gradientSvg} />
